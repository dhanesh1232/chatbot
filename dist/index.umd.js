!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MyChatbot={})}(this,function(e){"use strict";let t=null;class i{constructor(e){if(t)return t;this.config={bubbleIcon:"ðŸ’¬",bubbleColor:"#4f46e5",iconColor:"#ffffff",pulseColor:"#34d399",tooltipText:"Chat with us!",tooltipColor:"#333333",tooltipBgColor:"#ffffff",closeClickOutside:!0,bubbleSize:56,bubblePosition:"bottom-right",iframeWidth:340,iframeHeight:500,iframeBorderRadius:8,ripple:!0,rippleSpeed:1.5,autoOpen:0,shadow:"0 25px 50px -12px rgba(0,0,0,0.4)",bubbleShadow:"0 10px 40px rgba(0,0,0,0.2)",...e},this.bubble=null,this.iframe=null,this.rippleElements=[],this.autoOpenTimeout=null,this.isOpen=!1,window.addEventListener("message",e=>{"https://app.ecodrix.com"!==e.origin&&"http://localhost:3000"!==e.origin||"CHAT_WIDGET_CLOSE"===e.data?.type&&this.hideIframe()}),window.addEventListener("resize",()=>this.updateDimensions()),window.addEventListener("orientationchange",()=>this.updateDimensions())}init(){this.updateDimensions(),this.addStyles(),this.createBubble(),this.preloadIframe(),this.config.autoOpen>0&&(this.autoOpenTimeout=setTimeout(()=>this.showIframe(),1e3*this.config.autoOpen)),this.config.ripple&&this.createRippleEffect()}updateDimensions(){if(!this.iframe)return;const e=window.innerWidth,t=window.innerHeight;let i=this.config.iframeWidth,n=this.config.iframeHeight;e<=768&&(i=Math.min(360,.9*i),n=Math.min(540,1*n)),e<=480&&(i=e-80,n=.7*t),this.iframe.style.width=`${i}px`,this.iframe.style.height=`${n}px`}addStyles(){if(document.getElementById("ecodrix-widget-styles"))return;const e=document.createElement("style");e.id="ecodrix-widget-styles",e.textContent="\n      @keyframes ecodrix-ripple {\n        0% { transform: scale(0.8); opacity: 0.6; }\n        50% { transform: scale(1.1); opacity: 0.3; }\n        100% { transform: scale(1.4); opacity: 0; }\n      }\n      @keyframes ecodrix-bubble-float {\n        0% { transform: translateY(0px) scale(1); }\n        50% { transform: translateY(-5px) scale(1.02); }\n        100% { transform: translateY(0px) scale(1); }\n      }\n      @keyframes ecodrix-bubble-pulse {\n        0% { box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.4); }\n        70% { box-shadow: 0 0 0 15px rgba(79, 70, 229, 0); }\n        100% { box-shadow: 0 0 0 0 rgba(79, 70, 229, 0); }\n      }\n\n    ",document.head.appendChild(e)}createBubble(){this.bubble=document.createElement("div"),this.bubble.className="ecodrix-bubble-enter";const e=this.config.bubbleIcon,t=document.createElement("div");if(t.style.cssText="\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: transform 0.3s ease;\n    ",e)if(e.trim().startsWith("<svg"))t.innerHTML=e;else if(/^(http|\/|\.\/)/.test(e)){const i=document.createElement("img");i.src=e,i.style.cssText="\n        width: 60%;\n        height: 60%;\n        object-fit: contain;\n        filter: brightness(0) invert(1);\n      ",t.appendChild(i)}else t.innerText=e,t.style.fontSize=this.config.bubbleSize/2.5+"px";else t.innerText="ðŸ’¬";const i=this.config.bubblePosition.split("-");this.bubble.style.cssText=`\n      position: fixed;\n      ${i[0]}: 24px;\n      ${i[1]}: 16px;\n      width: ${this.config.bubbleSize}px;\n      height: ${this.config.bubbleSize}px;\n      border-radius: 50%;\n      background: linear-gradient(135deg, ${this.config.bubbleColor}, ${this.shadeColor(this.config.bubbleColor,-20)});\n      color: white;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n      z-index: 100000;\n      overflow: hidden;\n      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n      box-shadow: ${this.config.bubbleShadow};\n      border: 2px solid rgba(255, 255, 255, 0.1);\n    `,this.bubble.appendChild(t),document.body.appendChild(this.bubble),this.bubble.addEventListener("mouseenter",()=>{this.bubble.style.transform="scale(1.1)",t.style.transform="scale(1.1)"}),this.bubble.addEventListener("mouseleave",()=>{this.isOpen||(this.bubble.style.transform="scale(1)",t.style.transform="scale(1)")}),this.bubble.addEventListener("click",()=>this.toggleIframe())}createRippleEffect(){for(let e=0;e<3;e++){const t=document.createElement("div");t.style.cssText=`\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        border-radius: 50%;\n        top: 0;\n        left: 0;\n        pointer-events: none;\n        border: 2px solid rgba(255, 255, 255, 0.3);\n        animation: ecodrix-ripple ${(3-e)/this.config.rippleSpeed}s ease-in-out infinite;\n        animation-delay: ${.5*e}s;\n      `,this.bubble.appendChild(t),this.rippleElements.push(t)}setInterval(()=>{this.bubble.classList.add("ecodrix-bubble-pulse"),setTimeout(()=>{this.bubble.classList.remove("ecodrix-bubble-pulse")},2e3)},1e4)}preloadIframe(){this.iframe=document.createElement("iframe"),this.iframe.src=this.config.botUrl,this.iframe.allow="microphone",this.iframe.style.cssText=`\n      position: fixed;\n      bottom: ${this.config.bubbleSize+24}px;\n      right: 16px;\n      width: ${this.config.iframeWidth}px;\n      height: ${this.config.iframeHeight}px;\n      border: none;\n      border-radius: ${this.config.iframeBorderRadius}px;\n      box-shadow: ${this.config.shadow};\n      z-index: 99999;\n      opacity: 0;\n      transform: scale(0.8) translateY(20px);\n      transform-origin: bottom right;\n      pointer-events: none;\n      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n      background: white;\n    `,document.body.appendChild(this.iframe)}toggleIframe(){this.isOpen?this.hideIframe():this.showIframe()}showIframe(){this.iframe&&this.bubble&&(this.isOpen=!0,this.rippleElements.forEach(e=>e.style.display="none"),this.bubble.style.transform="scale(0.8)",this.bubble.style.opacity="0.7",this.bubble.style.boxShadow="0 4px 16px rgba(0,0,0,0.1)",this.iframe.style.opacity="1",this.iframe.style.transform="scale(1) translateY(0)",this.iframe.style.pointerEvents="auto")}hideIframe(){this.iframe&&this.bubble&&(this.isOpen=!1,this.iframe.style.opacity="0",this.iframe.style.transform="scale(0.8) translateY(20px)",this.iframe.style.pointerEvents="none",setTimeout(()=>{this.bubble.style.transform="scale(1)",this.bubble.style.opacity="1",this.bubble.style.boxShadow=this.config.bubbleShadow,this.rippleElements.forEach(e=>e.style.display="block")},200))}shadeColor(e,t){let i=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),s=parseInt(e.substring(5,7),16);i=Math.min(255,Math.round(i*(100+t)/100)),n=Math.min(255,Math.round(n*(100+t)/100)),s=Math.min(255,Math.round(s*(100+t)/100));return`#${i.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}`}destroy(){this.iframe&&this.iframe.remove(),this.bubble&&this.bubble.remove(),this.autoOpenTimeout&&clearTimeout(this.autoOpenTimeout),this.rippleElements=[];const e=document.getElementById("ecodrix-widget-styles");e&&e.remove(),t=null}}"undefined"!=typeof window&&(window.ECODrIx={init:e=>(t=new i(e),t.init(),t),destroy:()=>t?.destroy(),show:()=>t?.showIframe(),hide:()=>t?.hideIframe()}),e.ECODrIx=i,Object.defineProperty(e,"__esModule",{value:!0})});

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MyChatbot={})}(this,function(e){"use strict";let t=null;class i{constructor(e){if(t)return t;this.config={bubbleIcon:"ðŸ’¬",bubbleColor:"#4f46e5",bubbleSize:60,bubblePosition:"bottom-right",iframeWidth:350,iframeHeight:500,iframeBorderRadius:10,ripple:!0,rippleSpeed:1.5,autoOpen:0,...e},this.bubble=null,this.iframe=null,this.autoOpenTimeout=null,window.addEventListener("message",e=>{"https://app.ecodrix.com"!==e.origin&&"http://localhost:3000"!==e.origin||"CHAT_WIDGET_CLOSE"===e.data?.type&&this.hideIframe()})}init(){this.createBubble(),this.preloadIframe(),this.config.autoOpen>0&&(this.autoOpenTimeout=setTimeout(()=>this.showIframe(),1e3*this.config.autoOpen)),this.config.ripple&&this.createRipple()}createBubble(){this.bubble=document.createElement("div");const e=this.config.bubbleIcon;if(e)if(e.trim().startsWith("<svg"))this.bubble.innerHTML=e;else if(/^(http|\/|\.\/)/.test(e)){const t=document.createElement("img");t.src=e,t.style.maxWidth="70%",t.style.maxHeight="70%",t.style.objectFit="contain",this.bubble.appendChild(t)}else this.bubble.innerText=e;else this.bubble.innerText="ðŸ’¬";const t=this.config.bubblePosition.split("-");this.bubble.style.cssText=`\n      position: fixed;\n      ${t[0]}: 20px;\n      ${t[1]}: 20px;\n      width: ${this.config.bubbleSize}px;\n      height: ${this.config.bubbleSize}px;\n      border-radius: 50%;\n      background: ${this.config.bubbleColor};\n      color: white;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n      z-index: 99999;\n      font-size: ${this.config.bubbleSize/2}px;\n      overflow: hidden;\n      transition: transform 0.2s ease, opacity 0.3s ease;\n    `,document.body.appendChild(this.bubble),this.bubble.addEventListener("click",()=>this.showIframe())}createRipple(){const e=document.createElement("div");e.style.cssText=`\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n      top: 0;\n      left: 0;\n      pointer-events: none;\n      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4);\n      animation: ripple ${1.2/this.config.rippleSpeed}s infinite;\n    `,this.bubble.appendChild(e);const t=document.createElement("style");t.textContent="\n      @keyframes ripple {\n        0% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(255,255,255,0.4); }\n        70% { transform: scale(1.2); box-shadow: 0 0 10px 10px rgba(255,255,255,0); }\n        100% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(255,255,255,0); }\n      }\n    ",document.head.appendChild(t)}preloadIframe(){this.iframe=document.createElement("iframe"),this.iframe.src=this.config.botUrl,this.iframe.style.cssText=`\n      position: fixed;\n      bottom: ${this.config.bubbleSize}px;\n      right: 20px;\n      width: ${this.config.iframeWidth}px;\n      height: ${this.config.iframeHeight}px;\n      border: none;\n      border-radius: ${this.config.iframeBorderRadius}px;\n      box-shadow: 0 8px 24px rgba(0,0,0,0.3);\n      z-index: 99998;\n      opacity: 0;\n      transform: scale(0.5);\n      transform-origin: bottom right;\n      pointer-events: none;\n      transition: opacity 0.3s ease, transform 0.3s ease;\n    `,document.body.appendChild(this.iframe)}showIframe(){this.iframe&&this.bubble&&(this.bubble.style.transform="scale(0.9)",setTimeout(()=>this.bubble.style.display="none",150),this.iframe.style.opacity="1",this.iframe.style.transform="scale(1)",this.iframe.style.pointerEvents="auto")}hideIframe(){this.iframe&&this.bubble&&(this.iframe.style.opacity="0",this.iframe.style.transform="scale(0.5)",this.iframe.style.pointerEvents="none",setTimeout(()=>this.bubble.style.display="flex",200),this.bubble.style.transform="scale(1)")}destroy(){this.iframe&&this.iframe.remove(),this.bubble&&this.bubble.remove(),this.autoOpenTimeout&&clearTimeout(this.autoOpenTimeout),this.iframe=null,this.bubble=null,t=null}}"undefined"!=typeof window&&(window.ECODrIx={init:e=>{t=new i(e),t.init()},destroy:()=>t?.destroy()}),e.ECODrIx=i,Object.defineProperty(e,"__esModule",{value:!0})});
